"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[737],{7447(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"authentication/access-tokens","title":"Access Tokens","description":"Understanding and managing Instagram access tokens.","source":"@site/docs/authentication/access-tokens.md","sourceDirName":"authentication","slug":"/authentication/access-tokens","permalink":"/Instagram-graph-api-sdk/authentication/access-tokens","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"OAuth Overview","permalink":"/Instagram-graph-api-sdk/authentication/oauth-overview"},"next":{"title":"SDK OAuth Implementation","permalink":"/Instagram-graph-api-sdk/authentication/sdk-oauth"}}');var t=s(4848),r=s(8453);const o={sidebar_position:2},a="Access Tokens",l={},c=[{value:"Token Types",id:"token-types",level:2},{value:"Short-Lived Token",id:"short-lived-token",level:3},{value:"Long-Lived Token",id:"long-lived-token",level:3},{value:"Token Lifecycle",id:"token-lifecycle",level:2},{value:"Getting Tokens",id:"getting-tokens",level:2},{value:"Via OAuth Flow (Production)",id:"via-oauth-flow-production",level:3},{value:"Via Dashboard (Testing)",id:"via-dashboard-testing",level:3},{value:"Refreshing Tokens",id:"refreshing-tokens",level:2},{value:"Checking Token Info",id:"checking-token-info",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Store Tokens Securely",id:"1-store-tokens-securely",level:3},{value:"2. Handle Expiration",id:"2-handle-expiration",level:3},{value:"3. Multi-User Apps",id:"3-multi-user-apps",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"access-tokens",children:"Access Tokens"})}),"\n",(0,t.jsx)(n.p,{children:"Understanding and managing Instagram access tokens."}),"\n",(0,t.jsx)(n.h2,{id:"token-types",children:"Token Types"}),"\n",(0,t.jsx)(n.h3,{id:"short-lived-token",children:"Short-Lived Token"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Duration:"})," 1 hour"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Obtained via:"})," OAuth code exchange"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use:"})," Immediately exchange for long-lived token"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"long-lived-token",children:"Long-Lived Token"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Duration:"})," 60 days"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Obtained via:"})," Exchange short-lived token or dashboard"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use:"})," All API requests"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"token-lifecycle",children:"Token Lifecycle"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-mermaid",children:"graph LR\n    A[Auth Code] --\x3e|1 hour| B[Short-Lived Token]\n    B --\x3e|Exchange| C[Long-Lived Token]\n    C --\x3e|60 days| D[Expired]\n    C --\x3e|Refresh| C\n"})}),"\n",(0,t.jsx)(n.h2,{id:"getting-tokens",children:"Getting Tokens"}),"\n",(0,t.jsx)(n.h3,{id:"via-oauth-flow-production",children:"Via OAuth Flow (Production)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { InstagramOAuth } from 'instagram-graph-api-sdk';\n\n// Exchanges code \u2192 short-lived \u2192 long-lived automatically\nconst tokens = await InstagramOAuth.exchangeCodeForToken({\n  clientId: process.env.INSTAGRAM_APP_ID!,\n  clientSecret: process.env.INSTAGRAM_APP_SECRET!,\n  redirectUri: 'https://your-app.com/callback',\n  code: authorizationCode,\n});\n\n// tokens.access_token is already long-lived!\n"})}),"\n",(0,t.jsx)(n.h3,{id:"via-dashboard-testing",children:"Via Dashboard (Testing)"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Go to ",(0,t.jsx)(n.a,{href:"https://developers.facebook.com/apps/",children:"Meta App Dashboard"})]}),"\n",(0,t.jsxs)(n.li,{children:["Navigate to ",(0,t.jsx)(n.strong,{children:"Instagram"})," \u2192 ",(0,t.jsx)(n.strong,{children:"API setup with Instagram Login"})]}),"\n",(0,t.jsxs)(n.li,{children:["Click ",(0,t.jsx)(n.strong,{children:"Generate token"})," next to your account"]}),"\n",(0,t.jsx)(n.li,{children:"Copy the token (already long-lived)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"refreshing-tokens",children:"Refreshing Tokens"}),"\n",(0,t.jsx)(n.p,{children:"Long-lived tokens can be refreshed if they are:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["At least ",(0,t.jsx)(n.strong,{children:"24 hours old"})]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Not yet expired"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { InstagramClient } from 'instagram-graph-api-sdk';\n\nconst client = new InstagramClient({\n  accessToken: userAccessToken,\n});\n\n// Refresh the token\nconst refreshed = await client.auth.refreshToken();\n\nconsole.log('New token:', refreshed.access_token);\nconsole.log('Expires in:', refreshed.expires_in, 'seconds');\n\n// Save the new token!\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Automate Refreshes",type:"tip",children:(0,t.jsx)(n.p,{children:"Set up a cron job to refresh tokens weekly. This ensures tokens never expire."})}),"\n",(0,t.jsx)(n.h2,{id:"checking-token-info",children:"Checking Token Info"}),"\n",(0,t.jsx)(n.p,{children:"Get info about the current token:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const me = await client.auth.me('id,username,account_type');\n\nconsole.log('User ID:', me.id);\nconsole.log('Username:', me.username);\nconsole.log('Account Type:', me.account_type);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { isAuthenticationError } from 'instagram-graph-api-sdk';\n\ntry {\n  const profile = await client.users.getProfile();\n} catch (error) {\n  if (isAuthenticationError(error)) {\n    // Token is invalid or expired\n    // Redirect user to re-authenticate\n    console.log('Please log in again');\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"1-store-tokens-securely",children:"1. Store Tokens Securely"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Use encrypted database columns"}),"\n",(0,t.jsx)(n.li,{children:"Never log tokens"}),"\n",(0,t.jsx)(n.li,{children:"Never send tokens to client-side"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-handle-expiration",children:"2. Handle Expiration"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Track token expiration dates"}),"\n",(0,t.jsx)(n.li,{children:"Refresh proactively (e.g., 7 days before expiry)"}),"\n",(0,t.jsx)(n.li,{children:"Handle auth errors gracefully"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"3-multi-user-apps",children:"3. Multi-User Apps"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Store per-user tokens\nconst userToken = await database.getTokenForUser(userId);\n\n// Create client for specific user\nconst client = new InstagramClient({\n  accessToken: userToken,\n});\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>a});var i=s(6540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);